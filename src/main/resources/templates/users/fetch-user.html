<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
<meta charset="UTF-8">
<title>Insert title here</title>
	<script th:src="@{/js/jquery-3.7.1.min.js}"></script>
	<script th:inline="javascript">
	$(function() {
		$("#listBtn").click(function() {
			fetch("/users", {
				method: "GET",
				headers: {
					"Accept": "application/json"
				}				
			})
			.then(response => {
				if(!response.ok) {
					throw new Error("네트워크 응답 오류");
				}
				return response.json();
			})
			.then(data => {
				console.log(data);
				alert("목록 가져오기 성공");	
			})
			.catch(error => {
				console.log("오류 발생 : ", error);
				alert("목록 가져오기 오류")
			});
		});
		
		$("#addBtn").click(function() {
			const users = {
				usrname: $("#usrname").val(),
				psw: $("#psw").val(),
			}
			fetch("/users/signup", {
				method: "POST",
				headers: {
					"Content-Type": "application/json",
					"Accept": "application/json"
				},
				body: JSON.stringify(users)
			})
			.then(response => {
				if(!response.ok) {
					throw new Error("네트워크 응답 오류");	
				}
				return response.text();
			})
			.then(data => {
				console.log(data);
				alert("회원 가입 성공");
			})
			.catch(error => {
				console.log("오류 발생: ", error);
				alert("회원 가입 오류");
			});
		});
		
	});
	</script>
</head>
<body>
	<form>
		<label for="usrname">USRNAME : </label>
		<input type="text" id="usrname" name="usrname"/><br>
		<label for="psw">PSW : </label>
		<input type="text" id="psw" name="psw"/><br>		
	</form>
	<div>
		<button id="addBtn">회원 가입</button><br><br>
		<button id="listBtn">회원 목록</button><br>			
	</div>
</body>
</html>